# PDF 파싱 결과 분석 리포트

## 📊 전체 통계

- **총 파일 수**: 26개
- **파싱 성공률**: 100% (26/26)
- **평균 코드 추출**: 174.7개/파일

## 📈 정보 추출 성공률

| 항목 | 성공 | 실패 | 성공률 |
|------|------|------|--------|
| **보험기간** | 9 | 17 | **34.6%** |
| **납입기간** | 9 | 17 | **34.6%** |
| **가입나이** | 9 | 17 | **34.6%** |
| **갱신여부** | 2 | 24 | **7.7%** |

## ✅ 성공 사례 (보험기간/납입기간/가입나이 추출 성공)

| 파일명 | 보험코드 | 코드수 | 갱신 |
|--------|----------|--------|------|
| UW16932.pdf | 16932 | 0 | ✗ |
| UW17147.pdf | 17147 | 10 | ✗ |
| UW17153.pdf | 17153 | 10 | ✗ |
| UW18108.pdf | 18108 | 0 | ✗ |
| **UW19771.pdf** | **19771** | **356** | **✓** |
| **UW20307.pdf** | **20307** | **0** | **✓** |
| UW21121.pdf | 21121 | 18 | ✗ |
| UW21621.pdf | 21621 | 9 | ✗ |
| UW21843.pdf | 21843 | 0 | ✗ |

## ❌ 실패 사례 (보험기간/납입기간/가입나이 추출 실패)

| 파일명 | 보험코드 | 코드수 | 특이사항 |
|--------|----------|--------|----------|
| UW17027.pdf | 17027 | 7 | - |
| UW17037.pdf | 17037 | 7 | - |
| UW17212.pdf | 17212 | 0 | 코드 미추출 |
| UW17215.pdf | 17215 | 9 | - |
| UW17232.pdf | 17232 | 0 | 코드 미추출 |
| UW20908.pdf | 20908 | 0 | 코드 미추출 |
| UW21140.pdf | 21140 | 0 | 코드 미추출 |
| **UW21239.pdf** | **21239** | **93** | **많은 코드 추출됨** |
| **UW21385.pdf** | **21385** | **977** | **매우 많은 코드** |
| **UW21492.pdf** | **21492** | **977** | **매우 많은 코드** |
| **UW21619.pdf** | **21619** | **678** | **많은 코드 추출됨** |
| UW21819.pdf | 21819 | 6 | - |
| UW21828.pdf | 21828 | 28 | - |
| UW21867.pdf | 21867 | 0 | 코드 미추출 |
| **UW21893.pdf** | **21893** | **678** | **많은 코드 추출됨** |
| UW21929.pdf | 21929 | 0 | 코드 미추출 |

## 🔍 주요 발견 사항

### 1. 코드 추출 성공률
- **매우 높음**: OCR이 상품 코드를 매우 잘 추출함 (총 4,541개)
- **일부 파일 코드 미추출**: 8개 파일에서 코드가 전혀 추출되지 않음
- **대량 코드 추출**: 일부 파일에서 600개 이상의 코드 추출 (UW21385, UW21492, UW21619, UW21815, UW21893)

### 2. 보험기간/납입기간/가입나이 추출 문제
- **성공률 낮음**: 34.6% (9/26)
- **패턴 문제**: 현재 정규식 패턴이 실제 PDF 구조와 맞지 않음
- **OCR 텍스트 품질**: OCR이 텍스트를 추출하지만 구조가 깨짐

### 3. 갱신여부 추출 문제
- **성공률 매우 낮음**: 7.7% (2/26)
- **패턴 개선 필요**: 갱신 관련 텍스트 패턴 재분석 필요

## 💡 개선 방안

### 1. 정규식 패턴 개선
- **현재 문제**: 너무 일반적인 패턴 사용
- **해결 방안**: 
  - 성공 사례(UW19771, UW21121 등)의 실제 텍스트 분석
  - PDF 구조별 맞춤 패턴 개발
  - 표 형식 데이터 추출 로직 추가

### 2. PDF 구조 분석 강화
- **섹션 분리**: "4. 사업방법" 섹션을 더 정확하게 분리
- **표 데이터 추출**: 보험기간/납입기간/가입나이가 표 형식인 경우 대응
- **다중 패턴**: 여러 형식의 PDF에 대응하는 다중 패턴 적용

### 3. OCR 품질 개선
- **전처리**: PDF를 이미지로 변환 시 품질 향상
- **한글 인식**: Tesseract 한글 인식 정확도 개선
- **후처리**: 추출된 텍스트의 노이즈 제거

### 4. 하이브리드 접근
- **Java + Python 결합**: 두 방법의 장점 결합
- **규칙 기반 + ML**: 기계학습 모델 도입 검토
- **수동 검증**: 중요 필드는 수동 검증 프로세스 추가

## 📋 다음 단계

1. **성공 사례 분석**: UW19771, UW21121 등의 PDF를 수동으로 분석
2. **패턴 재설계**: 실제 PDF 구조에 맞는 정규식 패턴 재설계
3. **테스트 및 검증**: 개선된 패턴으로 재파싱 후 성공률 측정
4. **문서화**: 각 PDF 유형별 파싱 전략 문서화

## 🎯 목표 성공률

| 항목 | 현재 | 목표 |
|------|------|------|
| 보험기간 | 34.6% | **80%+** |
| 납입기간 | 34.6% | **80%+** |
| 가입나이 | 34.6% | **80%+** |
| 갱신여부 | 7.7% | **60%+** |
| 코드 추출 | 매우 높음 | **유지** |

---

**생성일**: 2025-10-11  
**분석 대상**: C:\insu_app\insuPdf (26개 파일)  
**결과 저장**: C:\insu_app\parse_results



